<%
   max_sender_len = 25
   max_subject_len = 40
%>

<table border="1">
  <tr>
    <td></td>
    <td><%= show_to ? 'To' : 'From' %></td>
    <td>Subject</td>
    <td>Date</td>
    <% if include_auto_filed_folder %>
      <td>Folder Moved To</td>
    <% end %>
  </tr>

  <% (0...emails.count).each do |email_num| %>
    <% email = emails[email_num] %>
    <tr>
      <td><%= email_num + 1 %></td>
      <td>
        <% if show_to %>
          <%= truncate(email.tos.to_s() + email.ccs.to_s() + email.bccs.to_s(), :length => max_sender_len) %>
        <% else %>
          <%= mail_to(email.from_address) do
              truncate(email.from_name ? email.from_name : email.from_address, :length => max_sender_len)
            end %>
        <% end %>
      </td>
      <td><%= truncate(email.subject, :length => max_subject_len) %></td>
      <td><%= email.date.to_s_local() %></td>
      <% if include_auto_filed_folder %>
        <td><%= email.auto_filed_folder.name %></td>
      <% end %>
    </tr>
  <% end %>
</table>
